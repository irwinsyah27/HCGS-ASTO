<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2005/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <DataSources>
    <DataSource Name="DataSource2">
      <rd:DataSourceID>bec78f95-b347-4031-8fdb-a508b3dc43e1</rd:DataSourceID>
      <DataSourceReference>DataSource2</DataSourceReference>
    </DataSource>
  </DataSources>
  <InteractiveHeight>11in</InteractiveHeight>
  <ReportParameters>
    <ReportParameter Name="Departemen">
      <DataType>String</DataType>
      <Prompt>Departemen</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DataDepartemen</DataSetName>
          <ValueField>Dept</ValueField>
          <LabelField>Dept</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="a">
      <DataType>DateTime</DataType>
      <Prompt>Awal :</Prompt>
    </ReportParameter>
    <ReportParameter Name="b">
      <DataType>DateTime</DataType>
      <Prompt>Akhir :</Prompt>
    </ReportParameter>
  </ReportParameters>
  <rd:DrawGrid>true</rd:DrawGrid>
  <InteractiveWidth>8.5in</InteractiveWidth>
  <rd:GridSpacing>0.25cm</rd:GridSpacing>
  <rd:SnapToGrid>true</rd:SnapToGrid>
  <RightMargin>1cm</RightMargin>
  <LeftMargin>1.5cm</LeftMargin>
  <BottomMargin>2.5cm</BottomMargin>
  <rd:ReportID>ad79cc0c-8d25-4e2a-8508-9756da5013e8</rd:ReportID>
  <PageWidth>21cm</PageWidth>
  <DataSets>
    <DataSet Name="DataSource2">
      <Fields>
        <Field Name="Nrp">
          <DataField>nrp</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Nama">
          <DataField>NAMA</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Dept">
          <DataField>Dept</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Golongan">
          <DataField>Golongan</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Lembur">
          <DataField>Lembur</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="MalamHari">
          <DataField>MalamHari</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="SiangHari">
          <DataField>SiangHari</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="TotalHari">
          <DataField>TotalHari</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource2</DataSourceName>
        <CommandText>SELECT     nrp, NAMA, Dept, Golongan, SUM(Lembur) AS Lembur, SUM(MalamHari) AS MalamHari, SUM(SiangHari) AS SiangHari, SUM(TotalHari) AS TotalHari
FROM         (SELECT     A.nrp, A.NAMA, A.OprNonOpr, A.Dept, A.Bulan, A.tanggal, '15/' + CONVERT(Varchar, CAST(SUBSTRING(A.Bulan, 1, 2) AS Integer) - 1) 
                                              + '/' + SUBSTRING(A.Bulan, 4, 4) AS Awal, '16/' + SUBSTRING(A.Bulan, 1, 2) + '/' + SUBSTRING(A.Bulan, 4, 4) AS Akhir, ((((((A.Ke1 * 1.5 + A.Ke2 * 2) 
                                              + A.Ke17 * 2) + A.Ke8 * 3) + A.Ke9dst * 4) + A.L17 * 3) + A.L8 * 4) + A.L9dst * 5 AS Lembur, B.JkpXfaXfatalXfspXfe AS Bonus, A.MalamHari, A.SiangHari, 
                                              A.MalamHari + A.SiangHari AS TotalHari, A.Golongan
                       FROM          dbo.VW_Rekap_Lembur_tgl AS A LEFT OUTER JOIN
                                              dbo.vw_Rekap_Bonus_a AS B ON A.nrp = B.Nrp AND A.Bulan = B.Bulan AND A.Bulan = B.Fpi_Bulan
                       WHERE      (A.Dept IN (@Departemen)) AND (A.tanggal BETWEEN @a AND @b)) AS TBL
GROUP BY nrp, NAMA, Dept, Golongan</CommandText>
        <QueryParameters>
          <QueryParameter Name="@Departemen">
            <Value>=Parameters!Departemen.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@a">
            <Value>=Parameters!a.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@b">
            <Value>=Parameters!b.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
    <DataSet Name="DataDepartemen">
      <Fields>
        <Field Name="Dept">
          <DataField>Dept</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource2</DataSourceName>
        <CommandText>Select Dept From Data_Abs1.dbo.tbl_dept</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
    </DataSet>
  </DataSets>
  <Code />
  <Width>20.28968cm</Width>
  <Body>
    <ColumnSpacing>1cm</ColumnSpacing>
    <ReportItems>
      <Textbox Name="textbox3">
        <Top>1.25cm</Top>
        <Width>2.75cm</Width>
        <Style>
          <FontWeight>700</FontWeight>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <ZIndex>5</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>2cm</Left>
        <Height>0.63492cm</Height>
        <Value>=Parameters!Departemen.Value(0)</Value>
      </Textbox>
      <Textbox Name="textbox2">
        <Top>1.25cm</Top>
        <Width>1.5cm</Width>
        <Style>
          <FontWeight>700</FontWeight>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <ZIndex>4</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>0.25cm</Left>
        <Height>0.63492cm</Height>
        <Value>Dept :</Value>
      </Textbox>
      <Textbox Name="textbox12">
        <Top>1.25cm</Top>
        <Width>2.53968cm</Width>
        <Style>
          <FontWeight>700</FontWeight>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <ZIndex>3</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>5cm</Left>
        <Height>0.63492cm</Height>
        <Value>Periode :</Value>
      </Textbox>
      <Textbox Name="textbox11">
        <Top>1.25cm</Top>
        <Width>8.26388cm</Width>
        <Style>
          <FontWeight>700</FontWeight>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <ZIndex>2</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>7.75cm</Left>
        <Height>0.63492cm</Height>
        <Value>="Tanggal : " &amp; Parameters!a.Value &amp; " s. d " &amp; Parameters!b.Value</Value>
      </Textbox>
      <Textbox Name="textbox1">
        <rd:DefaultName>textbox1</rd:DefaultName>
        <Width>17.5cm</Width>
        <Style>
          <FontFamily>Tahoma</FontFamily>
          <FontSize>18pt</FontSize>
          <FontWeight>700</FontWeight>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
        <ZIndex>1</ZIndex>
        <CanGrow>true</CanGrow>
        <Left>0.25cm</Left>
        <Height>0.91429cm</Height>
        <Value>Rekap Lembur Periode (MasterDetail)</Value>
      </Textbox>
      <Table Name="table1">
        <DataSetName>DataSource2</DataSetName>
        <Top>2cm</Top>
        <Details>
          <TableRows>
            <TableRow>
              <TableCells>
                <TableCell>
                  <ColSpan>8</ColSpan>
                  <ReportItems>
                    <Subreport Name="subreport1">
                      <Parameters>
                        <Parameter Name="Awal">
                          <Value>=Parameters!a.Value</Value>
                        </Parameter>
                        <Parameter Name="Akhir">
                          <Value>=Parameters!b.Value</Value>
                        </Parameter>
                        <Parameter Name="Nrp">
                          <Value>=Fields!Nrp.Value</Value>
                        </Parameter>
                      </Parameters>
                      <ReportName>Detail_ Lembur_Per_Periode_Per_Nrp</ReportName>
                      <Style>
                        <BorderColor>
                          <Default>LightGrey</Default>
                        </BorderColor>
                        <BorderStyle>
                          <Default>Solid</Default>
                        </BorderStyle>
                      </Style>
                    </Subreport>
                  </ReportItems>
                </TableCell>
              </TableCells>
              <Height>0.53333cm</Height>
            </TableRow>
          </TableRows>
        </Details>
        <TableColumns>
          <TableColumn>
            <Width>2.5cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>5.25cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>2.53968cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>2cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>2cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>2cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>2cm</Width>
          </TableColumn>
          <TableColumn>
            <Width>1.75cm</Width>
          </TableColumn>
        </TableColumns>
        <Height>0.53333cm</Height>
        <Left>0.25cm</Left>
      </Table>
    </ReportItems>
    <Height>3.25cm</Height>
  </Body>
  <Language>id-ID</Language>
  <TopMargin>2.5cm</TopMargin>
  <PageHeight>29.7cm</PageHeight>
</Report>